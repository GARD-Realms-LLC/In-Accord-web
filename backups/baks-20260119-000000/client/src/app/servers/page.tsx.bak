'use client';

import { useEffect, useMemo, useState } from 'react';

interface DiscordServerAd {
        id: string;
        headline: string;
        shortDescription: string;
        pricing: string;
        deliverables: string[];
        badge?: string;
        targetCommunity?: string;
        turnaround?: string;
        ctaLabel: string;
        ctaUrl: string;
        contactDiscord?: string;
        isFeatured?: boolean;
        createdAt: string;
        updatedAt: string;
        craftedBy?: string;
      }

    interface DiscordServerAdForm {
        headline: string;
        shortDescription: string;
        pricing: string;
        deliverablesText: string;
        badge: string;
        targetCommunity: string;
        turnaround: string;
        ctaLabel: string;
        ctaUrl: string;
        contactDiscord: string;
      }

    const STORAGE_KEY = 'discord_server_creator_ads';

    const extractRoleTokens = (user: any): string[] => {
        const tokens = new Set<string>();
        const addToken = (value: unknown) => {
          if (typeof value === 'string') {
            const matches = value.match(/[A-Za-z0-9]+/g);
            if (matches) {
              matches.forEach((match) => tokens.add(match.toLowerCase()));
            }
          }
        };





















































































































































































































































































































































































































export default ServersPage;};  );    </div>            </section>              </div>                ))}                  </article>                    </footer>                      </div>                        {ad.contactDiscord && <span>· Contact {ad.contactDiscord}</span>}                        {ad.craftedBy && <span>· Crafted by {ad.craftedBy}</span>}                        <span>Updated {formatTimestamp(ad.updatedAt)}</span>                      <div className="flex flex-col gap-1 text-xs text-gray-500 dark:text-gray-400 sm:flex-row sm:items-center sm:gap-3">                      </a>                        {ad.ctaLabel}                      >                        className="inline-flex items-center justify-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-indigo-700"                        rel="noopener noreferrer"                        target="_blank"                        href={ad.ctaUrl}                      <a                  <footer className="mt-6 flex flex-wrap items-center justify-between gap-3">                    </div>                      </ul>                        ))}                          </li>                            <span>{deliverable}</span>                            <span className="mt-1 h-1.5 w-1.5 rounded-full bg-indigo-500" aria-hidden></span>                          <li key={index} className="flex items-start gap-2">                        {ad.deliverables.map((deliverable, index) => (                      <ul className="space-y-2 text-sm text-gray-700 dark:text-gray-300">                      </div>                        )}                          <p className="text-xs text-gray-500 dark:text-gray-400">Turnaround: {ad.turnaround}</p>                        {ad.turnaround && (                        )}                          <p className="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">For {ad.targetCommunity}</p>                        {ad.targetCommunity && (                        <p className="text-2xl font-bold text-gray-900 dark:text-white">{ad.pricing}</p>                      <div className="rounded-2xl border border-gray-200 bg-white/70 p-4 dark:border-gray-700 dark:bg-gray-800/60">                      </p>                        {ad.shortDescription || 'Add a description to help communities understand the transformation offered.'}                      <p className="text-sm text-gray-600 dark:text-gray-300">                      </div>                        )}                          </span>                            {ad.badge}                          <span className="rounded-full bg-indigo-100 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-200">                        {ad.badge && (                        <h3 className="text-xl font-semibold text-gray-900 dark:text-white">{ad.headline}</h3>                      <div className="flex items-center justify-between">                  <div className="space-y-4">                  >                    }`}                        : 'border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900'                        ? 'border-indigo-400 bg-gradient-to-b from-indigo-50 to-white dark:from-indigo-900/40 dark:to-gray-900'                      ad.isFeatured                    className={`relative flex h-full flex-col justify-between rounded-2xl border p-6 shadow-sm transition hover:shadow-lg dark:border-gray-700 dark:bg-gray-900 ${                    key={ad.id}                <article                {sortedAds.map((ad) => (              <div className="grid gap-6 md:grid-cols-2 xl:grid-cols-3">              </header>                </div>                  Last update {ads[0] ? formatTimestamp(ads[0].updatedAt) : '—'}                <div className="rounded-full border border-emerald-200 bg-emerald-50 px-4 py-1 text-xs font-medium text-emerald-700 dark:border-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300">                </div>                  </p>                    Featured offers surface first. Each card mirrors how prospects experience your Discord development services.                  <p className="text-sm text-gray-600 dark:text-gray-300">                  <h2 className="text-2xl font-semibold text-gray-900 dark:text-white">Live Discord creator campaigns</h2>                <div>              <header className="flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between">            <section className="space-y-6">                      </div>              </div>                </div>                  </div>                    <div className="text-sm text-indigo-100">Featured placements</div>                    <div className="text-3xl font-bold">{stats.featured}</div>                  <div className="rounded-2xl border border-white/15 bg-white/10 p-5 backdrop-blur">                  </div>                    <div className="text-sm text-indigo-100">Live advertisements</div>                    <div className="text-3xl font-bold">{stats.total}</div>                  <div className="rounded-2xl border border-white/15 bg-white/10 p-5 backdrop-blur">                <div className="grid gap-4 sm:grid-cols-3">                </div>                  </p>                    SaaS teams, and esports organizations.                    Draft high-impact Discord server packages, iterate on campaigns, and showcase offers built for creators,                  <p className="text-lg text-indigo-100">                  </h1>                    Launch communities engineered to convert, retain, and delight.                  <h1 className="text-4xl font-extrabold tracking-tight sm:text-5xl">                  </span>                    Discord Servers Development Studio                  <span className="inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-4 py-1 text-sm font-medium backdrop-blur-sm">                <div className="max-w-3xl space-y-5">              <div className="relative flex flex-col gap-8 p-10 lg:p-16">              ></div>                aria-hidden                className="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.18),_transparent_55%)]"              <div            <div className="relative overflow-hidden rounded-3xl bg-gradient-to-r from-indigo-700 via-purple-600 to-sky-500 text-white">    <div className="space-y-10 p-8">  return (        }, [ads]);          return { total, featured };          const featured = ads.filter((ad) => ad.isFeatured).length;          const total = ads.length;
n  const stats = useMemo(() => {        };          );            })              return { ...ad, isFeatured: !ad.isFeatured };              if (ad.id !== id) return ad;            prev.map((ad) => {          setAds((prev) =>          if (!canManage) return;  const toggleFeatured = (id: string) => {        };          }            resetForm();          if (editingId === id) {          setAds((prev) => prev.filter((ad) => ad.id !== id));          if (!confirm('Remove this Discord server advertisement?')) return;          if (!canManage) return;
n  const handleDelete = (id: string) => {        };          });            contactDiscord: ad.contactDiscord ?? '',            ctaUrl: ad.ctaUrl,            ctaLabel: ad.ctaLabel,            turnaround: ad.turnaround ?? '',            targetCommunity: ad.targetCommunity ?? '',            badge: ad.badge ?? '',            deliverablesText: ad.deliverables.join('\n'),            pricing: ad.pricing,            shortDescription: ad.shortDescription,            headline: ad.headline,          setForm({          setEditingId(ad.id);          if (!canManage) return;
n  const handleEdit = (ad: DiscordServerAd) => {        };
n          resetForm();          }            setStatusMessage('New Discord server advertisement published.');            setAds((prev) => [newAd, ...prev]);            };              craftedBy: role || 'Discord Builder',              updatedAt: timestamp,              createdAt: timestamp,              isFeatured: false,              contactDiscord: form.contactDiscord.trim() || undefined,              ctaUrl: form.ctaUrl.trim(),              ctaLabel: form.ctaLabel.trim(),              turnaround: form.turnaround.trim() || undefined,              targetCommunity: form.targetCommunity.trim() || undefined,              badge: form.badge.trim() || undefined,              deliverables,              pricing: form.pricing.trim() || 'Custom quote',              shortDescription: form.shortDescription.trim(),              headline: form.headline.trim(),              id: generateId(),            const newAd: DiscordServerAd = {          } else {            setStatusMessage('Discord server advertisement updated.');            );              })                };                  craftedBy: role || 'Discord Builder',                  updatedAt: timestamp,                  contactDiscord: form.contactDiscord.trim() || undefined,                  ctaUrl: form.ctaUrl.trim(),                  ctaLabel: form.ctaLabel.trim(),                  turnaround: form.turnaround.trim() || undefined,                  targetCommunity: form.targetCommunity.trim() || undefined,                  badge: form.badge.trim() || undefined,                  deliverables,                  pricing: form.pricing.trim() || 'Custom quote',                  shortDescription: form.shortDescription.trim(),                  headline: form.headline.trim(),                  ...ad,                return {                if (ad.id !== editingId) return ad;              prev.map((ad) => {            setAds((prev) =>
n          if (editingId) {
n          const timestamp = new Date().toISOString();          }            return;            setStatusMessage('CTA label and URL are required.');
n          if (!form.ctaLabel.trim() || !form.ctaUrl.trim()) {          }            return;            setStatusMessage('Headline is required.');
n          if (!form.headline.trim()) {            .filter(Boolean);            .map((line) => line.trim())            .split('\n')
n          const deliverables = form.deliverablesText          if (!canManage) return;          event.preventDefault();  const handleSubmit: React.FormEventHandler<HTMLFormElement> = (event) => {        };          setForm((prev) => ({ ...prev, [field]: value }));  const handleChange = (field: keyof DiscordServerAdForm, value: string) => {        };          setEditingId(null);          setForm(emptyForm);  const resetForm = () => {        }, [ads]);          return [...ads].sort((a, b) => (b.isFeatured ? 1 : 0) - (a.isFeatured ? 1 : 0));  const sortedAds = useMemo(() => {        }, [statusMessage]);          return () => clearTimeout(timeout);          const timeout = setTimeout(() => setStatusMessage(null), 3500);          if (!statusMessage) return;  useEffect(() => {        }, []);          }            setCanManage(false);            setRole('');          } catch {            setCanManage(hasDiscord || hasCreator || hasAdmin);            setRole(formatRoleLabel(parsed, roleTokens));            const hasCreator = roleTokens.includes('creator');            const hasDiscord = roleTokens.includes('discord');            const hasAdmin = roleTokens.includes('admin');            const roleTokens = extractRoleTokens(parsed);            const parsed = JSON.parse(raw);            }              return;              setCanManage(false);              setRole('');            if (!raw) {            const raw = window.localStorage.getItem('currentUser');          try {          if (typeof window === 'undefined') return;  useEffect(() => {        }, [ads]);          }            // ignore persistence errors          } catch {            window.localStorage.setItem(STORAGE_KEY, JSON.stringify(ads));          try {          if (typeof window === 'undefined') return;  useEffect(() => {        const [canManage, setCanManage] = useState(false);        const [role, setRole] = useState<string>('');        const [statusMessage, setStatusMessage] = useState<string | null>(null);        const [editingId, setEditingId] = useState<string | null>(null);        const [form, setForm] = useState<DiscordServerAdForm>(emptyForm);        });          }            return DEFAULT_ADS;          } catch {            return parsed;            if (!Array.isArray(parsed) || parsed.length === 0) return DEFAULT_ADS;            const parsed = JSON.parse(stored) as DiscordServerAd[];            if (!stored) return DEFAULT_ADS;            const stored = window.localStorage.getItem(STORAGE_KEY);          try {          if (typeof window === 'undefined') return DEFAULT_ADS;        const [ads, setAds] = useState<DiscordServerAd[]>(() => {    const ServersPage = () => {      };        }          return iso;        } catch {          return new Date(iso).toLocaleString();        try {    const formatTimestamp = (iso: string) => {      };        return `discord-ad-${Math.random().toString(36).slice(2, 10)}`;        }          return crypto.randomUUID();        if (typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function') {    const generateId = () => {      };        contactDiscord: '',        ctaUrl: '',        ctaLabel: '',        turnaround: '',        targetCommunity: '',        badge: '',        deliverablesText: '',        pricing: '',        shortDescription: '',        headline: '',    const emptyForm: DiscordServerAdForm = {      ];        },          craftedBy: 'System',          updatedAt: '2026-01-03T12:45:00.000Z',          createdAt: '2026-01-03T12:45:00.000Z',          isFeatured: false,          contactDiscord: '@arenaops',          ctaUrl: 'https://example.com/discord/esports-command',          ctaLabel: 'Plan your season rollout',          turnaround: '6-week engagement',          targetCommunity: 'Esports orgs & tournament hosts',          badge: 'White-glove build',          ],            'Crisis comms runbooks for moderators and staff',            'Partner lounge with branded sponsor mini-sites',            'Caster & producer war rooms with OBS scene syncing',            'Bracket automation with Battlefy, Challonge, or Smash.gg',          deliverables: [          pricing: 'Custom quote',          shortDescription: 'Tournament-ready Discord stack with sponsor activations, scrim scheduling, and broadcast integrations.',          headline: 'Esports Command Center',          id: 'discord-esports',        {        },          craftedBy: 'System',          updatedAt: '2026-01-04T15:30:00.000Z',          createdAt: '2026-01-02T10:00:00.000Z',          isFeatured: true,          contactDiscord: '@supportgarden',          ctaUrl: 'https://example.com/discord/saas-nexus',          ctaLabel: 'Book an architecture session',          turnaround: '3-week build sprint',          targetCommunity: 'SaaS founders & customer teams',          badge: 'Most requested',          ],            'Triage macros and escalation playbooks for your support team',            'Insight dashboards surfaced inside Discord via Slash commands',            'Zendesk + Linear ticket sync with two-way webhooks',            'Role-gated spaces for success, VIP, and beta cohorts',          deliverables: [          pricing: 'Starting at $899',          shortDescription: 'Ship a Discord hub that doubles as customer success, beta testing lounge, and feature feedback engine.',          headline: 'SaaS Support Nexus',          id: 'discord-saas-pro',        {        },          craftedBy: 'System',          updatedAt: '2026-01-02T10:00:00.000Z',          createdAt: '2026-01-02T10:00:00.000Z',          isFeatured: true,          contactDiscord: '@guildsmith',          ctaUrl: 'https://example.com/discord/creator-guild',          ctaLabel: 'Review launch checklist',          turnaround: '14-day average launch',          targetCommunity: 'Content creators & knowledge entrepreneurs',          badge: 'Creator favorite',          ],            'Bi-weekly audit with retention and engagement reporting',            'Onboarding flows synced with Gumroad, Patreon, and Shopify',            'Automations with MEE6, Tatsu, and custom Slash commands',            'Modular channel architecture mapped to your revenue funnel',          deliverables: [          pricing: '$499 setup + $99/mo stewardship',          shortDescription: 'Custom Discord servers engineered for creators hosting courses, VIP drops, and Patreon-style perks.',          headline: 'Creator Guild Launch Kit',          id: 'discord-builder-pro',        {    const DEFAULT_ADS: DiscordServerAd[] = [      };        return '';        }            .join(', ');            .map((token) => token.charAt(0).toUpperCase() + token.slice(1))          return tokens        if (tokens.length) {        }          return user.role;        if (typeof user?.role === 'string' && user.role.trim().length) {        }            .join(', ');            .filter((role) => typeof role === 'string' && role.trim().length)          return user.roles        if (Array.isArray(user?.roles) && user.roles.length) {    const formatRoleLabel = (user: any, tokens: string[]): string => {      };        return Array.from(tokens);        addToken(user?.role);        }          user.roles.forEach(addToken);n        if (Array.isArray(user?.roles)) {